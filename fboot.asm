;===================== ??????????? ??????. ??????? ?????, 2011=====================
;==================================================================================
 org 7c00h  ;BIOS ?????????? ?????? 512 ???? ??????? ??????? MBR ? ??? ?? ?????? 0x00007C00 
            ;(0x07C0:0x0000 ? ??????? ????????? ??????), ????? ???????????? ???? ?????????? ??????????
start:
        cli             ;????????? ??????????
        xor ax,ax       ;???????? ??????? ??
        mov ds,ax       ;??????????? ??????? ?????? ?? ??????? ?????
        mov es,ax       ;??????????? ??????? es ?? ??????? ?????
        mov ss,ax       ;??????????? ??????? ????? ?? ??????? ?????
        mov sp,07C00h   ;??????? sp ????????? ?? ??????? ??????? ?????
        sti         ;????????? ??????????
            
        mov ax, 0002h   ;??????? ????? - ??????? 00h ?????????? 10h 
        int 10h
         
        mov dx,0h
        call SetCursorPos
         
        mov bp, msg             
        mov cx, 13
        call PrintMes   ;????? ?? ????? ?????? msg
         
        add dh,1        ;????????? ?? ???? ?????? ????
        call SetCursorPos
        mov bp, Con             ;????? ?? ????? ?????? Con
        mov cx, 23
        call PrintMes
                 
         mov ah,10h
         int 16h
                 
Continue:
        cmp al, 0Dh     ;???? ???????? ?? Enter, ?? ????????? ? ???????? ????
        jz Kernel
        jmp Continue    ;???? ???, ????? ??????? ??????? ???????
                 
Kernel:
        mov ax,0000h
        mov es,ax
        mov bx,500h
        mov ch,0            ;????? ???????? - 0
        mov cl,02h          ;????????? ?????? - 2
        mov dh,0            ;????? ??????? - 0
        mov dl,80h          ;??????? ???? - 80h
        mov al,01h          ;???-?? ???????? ???????? -1
        mov ah,02h
        int 13h
        jmp 0000:0500h      ;??????? ?? 0000:0500h, ???? ???????? ?????? ??????
 
;===================== ???????????? ===================================
PrintMes:                   ;? ????????  bp - ??????, ? ???????? cx - ????? ???? ??????
        mov bl,04h          ;? ????????  bl- ???????
        mov ax,1301h        ; ??????? 13h ?????????? 10h
        int 10h
        ret
        ;----------------------------------
SetCursorPos:        ;????????? ??????? : ??????? 02h ?????????? 10h
        mov ah,2h
        xor bh,bh
        int 10h 
        ret
            
;===================== ????????? ?????????===================== 
        msg db 'OS Loading...',0     
        Con db 'Press Enter to Continue',0
  
times(512-2-($-07C00h)) db 0
db 055h,0AAh ;?????????, ??????????????? ? ?????????? ???????????? ???????